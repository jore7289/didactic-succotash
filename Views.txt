
DROP VIEW AttDatatype;
DROP VIEW EntKey;
DROP VIEW KeyAttr;
DROP VIEW All_Ents;
DROP VIEW All_Atts;
DROP VIEW All_Keys;
DROP VIEW All_Rels;


CREATE VIEW AttDatatype AS
SELECT Name, AttributeType FROM Attribute;

CREATE VIEW EntKey AS
SELECT Name FROM Attribute
WHERE KeyType = 'PRIMARY KEY';

CREATE VIEW KeyAttr AS
SELECT A1.Name, LISTAGG(A2.Name, ',') Attributes FROM Attribute A1, Attribute A2
WHERE A1.EntityId = A2.EntityId
AND A1.KeyType = 'PRIMARY KEY'
AND A2.KeyType = 'PRIMARY KEY'
GROUP BY A1.Name;

CREATE VIEW All_Ents AS
SELECT * FROM ENTITY;

CREATE VIEW All_Atts AS
SELECT * FROM Attribute;

CREATE VIEW All_Keys AS
SELECT * FROM KeyAttr;

CREATE VIEW All_Rels AS
SELECT * FROM relationship;
